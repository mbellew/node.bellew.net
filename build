#LINUX
#export node=nodejs

#WINDOWS
export node=node.exe

export tsc=" ./node_modules/.bin/tsc --jsx react --sourceMap"
export rt="$node ./node_modules/react-templates/bin/rt.js"
export md="$node node_modules/marked/bin/marked"

mkdir dist 
mkdir dist/server
mkdir dist/www
mkdir dist/www/static

# static files
cp src/static/index.html dist/www/index.html
cp src/static/*.html dist/www/static/
cp src/static/*.gif dist/www/static/
cp src/static/*.jpg dist/www/static/
cp src/static/*.js dist/www/static/
cp src/static/*.css dist/www/static/
cp node_modules/react/dist/* dist/www/static/
cp node_modules/react-dom/dist/* dist/www/static/

# markdown
shopt -s nullglob
for f in src/static/*.md
do
    echo $md < $f > dist/www/static/$(basename "$f" .md).html
    $md < $f > dist/www/static/$(basename "$f" .md).html
done

#script and template files
echo $tsc src/static/bellew.tsx -outDir dist/www/static/
$tsc src/static/bellew.tsx -outDir dist/www/static/

echo $tsc src/static/social.tsx -outDir dist/www/static/
$tsc src/static/social.tsx -outDir dist/www/static/

echo $tsc src/server/server.tsx -outDir dist/www/server/
$tsc src/server/server.tsx -outDir dist/server/
